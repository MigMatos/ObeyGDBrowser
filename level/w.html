<head>
	<link href="../assets/css/browser.css?v=15" type="text/css" rel="stylesheet">
	<title>[[NAME]] ([[ID]])</title>
	<meta charset="utf-8">
	
    
	<link rel="icon" href="../assets/difficulties/[[DIFFICULTYFACE]].png">
	<meta id="meta-title" property="og:title" content="[[NAME]] by [[AUTHOR]]">
	<meta id="meta-desc" property="og:description" content="ID: [[ID]] | Stars: [[STARS]] | Difficulty: [[DIFFICULTY]] | Downloads: [[DOWNLOADS]] | Likes: [[LIKES]] | Length: [[LENGTH]] | Song: [[SONGNAME]] ([[SONGID]])">
	<meta id="meta-image" name="og:image" itemprop="image" content="../assets/difficulties/[[DIFFICULTYFACE]].png">
	<meta name="twitter:card" content="summary">
</head>

<style>
	.box-subopt {
		display: flex !important;
    	justify-content: center;
		flex-wrap: wrap;
		/* General */
		width: 98% !important;
		background-color: #00000065;
		border-radius: 2.5vh;
		padding: 1vh 1vh 1vh 1vh;
	}

	.box-subopt-checkbox {
		width: fit-content;
		display: flex;
		align-items: center;
		padding-right: 2.5vh;
	}

	.box-subopt-checkbox > .gdcheckbox {
		height: 5vh;
    	padding: 0vh 6vh 0vh 0vh;
	}

	.box-subopt > div.gdsButton {
		width: fit-content !important;
		min-width: 30%;
	}

	.box-subopt > div.gdsButton > .gdfont-Pusab {
		text-wrap: nowrap;
		text-align: center;
	}

	#filterStuff div {
		width: auto !important;
	}

	#filterStuff > h2.smaller.center {
		font-size: 3.5vh;
    	-webkit-text-stroke-width: 0.15vh !important;
	}

	#profileCBox {
		background-origin: border-box !important;
	}

	.diffDiv.gdButton {
		display: flex !important;
		flex-direction: column;
		align-items: center;
	}

	#difficulties, #demons {
		/* display: flex !important; */
		text-align: center;
		align-items: center;
	}

	.hideBox {
		display: none !important;
	}

	.showBox {
		display: flex !important;
	}

	input[type=checkbox] {
		width: 0vh;
		display: contents;
	}

	.outsideBox {
		left: -50%;
	}
	
	@keyframes bounceFromLeft {
		0% { left: -50%; }
		50% { left: 55%; }
		70% { left: 47%; }
		85% { left: 52%; }
		100% { left: 50%; }
	}

	@keyframes bounceFromRight {
		0% { left: 150%; }
		50% { left: 45%; }
		70% { left: 53%; }
		85% { left: 48%; }
		100% { left: 50%; }
	}

	.bounceLeft {
		animation: bounceFromLeft 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
	}

	.bounceRight {
		animation: bounceFromRight 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
	}
</style>

<body class="levelBG" style="background-image: none; background-color: transparent;" onbeforeunload="saveUrl()">

<div id="everything">
	<div class="center supercenter" style="height: 85%; width: 135vh" id="borderColorBox">
	</div>
	<div class="center supercenter" style="height: 83%; width: 134vh" id="backgroundColorBox">
	</div>
	<div class="brownbox center supercenter" style="height: 80%; width: 130vh" id="backgroundBox">
	</div>
	<div class="transparentBox center supercenter" style="height: 80%; width: 130vh; background-color: transparent;">
		<img class="" src="../assets/tabspecial/dailyLevelLabel.png" id="dailyLabel" width="55%" style="position: absolute;left: 22%;top: 1%;">

		<div class="transparentBox center" style="position: absolute;bottom: 25%;left: 0%;right: 0%;width: 95%;height: 40%;margin-left: auto;margin-right: auto;display: flex;justify-content: center;align-items: center;">
			<p class="pre" style="padding: 0 5%; white-space:normal">There is no current <span class="textTypeEvent">daily</span></p>
		</div>

		<img class="gdButton" src="../assets/close.png" width="7%" style="position: absolute;left: -5%;top: -6%;" onclick="closeMessageCustomFrame()">
		<img class="gdButton" src="../assets/tabspecial/theSafeBtn.png" width="7%" style="position: absolute;left: 91%;top: 4%;" onclick="searchRedirect('0','!safe')">

		<div style="position:absolute; bottom: 86.9%; left: -46.8%; width: 100%"><img class="cornerPiece" src="../assets/tabspecial/dailyLevelCorner.png" width=10%; style="transform: scaleY(-1)"></div>
		<div style="position:absolute; bottom: 86.9%; left: 46.9%; width: 100%"><img class="cornerPiece" src="../assets/tabspecial/dailyLevelCorner.png" width=10%; style="transform: scaleX(-1) scaleY(-1)"></div>
		<div style="position:absolute; bottom: -3.3%; left: 46.9%; width: 100%"><img class="cornerPiece" src="../assets/tabspecial/dailyLevelCorner.png" width=10%; style="transform: scaleX(-1)"></div>
		<div style="position:absolute; bottom: -3.3%; left: -46.8%; width: 100%"><img class="cornerPiece" src="../assets/tabspecial/dailyLevelCorner.png" width=10%;></div>
	</div>

	<!-- HERE -->

	<div class="transparentBox center supercenter" style="height: 100%; width: 165vh; background-color: transparent;pointer-events: none; ">
		<div class="brownBox center supercenter outsideBox" style="width: 72%;height: 28%;top: 54%;" id="randomBox">
			<div class="center valign" style="position:absolute;top: -15.5%;left: -4%;transform: scale(0.8);height: 250%;width: 22%;">

				<div class="difficultyBox" style="height: 12%; width: 50%; margin-left: auto; margin-right: auto;">
					<img id="gdItem13" class="help fFace" cp="[[FEATFACE]]" src="../assets/features/[[FEATFACE]].png">
					<img class="help" id="dFace" title="[[DIFFICULTY]]" src="../assets/difficulties/[[PARTIALDIFF]].png">
				</div>
		
				<h1 class="smaller" id="difficultytext" style="transform:scale(0.9);">[[DIFFICULTY]]</h1>
				<h1 id="gdItem13" class="smaller inline stars" style="transform:scale(0.9)">[[STARS]]</h1> <img id="gdItem13" class="inline stars" src="../assets/star.png" height=4%; style="transform:translateY(-12%)"><br class="stars">
				<h1 id="gdItem21" class="smaller inline diamonds" style="transform:scale(0.9)">[[DIAMONDS]]</h1> <img id="gdItem21" class="inline diamonds" src="../assets/diamond.png" height=4%; style="transform:translateY(-12%)">
				<h1 class="smaller inline demonList" style="transform:scale(0.9); display: none;">#[[DEMONLIST]]</h1> <img class="inline demonList" src="../assets/demon.png" height=4.5%; style="transform:translateY(-7%); display: none; margin-left: 1.5%">
				<div class="gdItem20" id="coins" style="margin-top: 3%"></div>
			</div>

			<div class="" style="width: 70%; margin: 1% auto; text-align: left;">
				<h1 class="pre" style="margin-left: 9%; transform: scale(1.2)">[[NAME]]</h1>
				<h2 class="pre inline slightlySmaller normalCursor gdButton" style="margin-top: 1%;" id="authorName"><a class="linkButton" id="authorLink" onclick="profileRedirect('[[ACCOUNTID]]')">By [[AUTHOR]]</a></h2>
				<h2 class="inline slightlySmaller normalCursor sideSpaceC">
					<img class="inline valign" id="copiedBadge" style="display: none; height: 9%; cursor:help" src="../assets/copied.png" title="Level is a copy or a collaboration">
					<img class="inline valign" id="largeBadge" style="display: none; height: 9%; margin-left: -7%; cursor:help" src="../assets/large.png" title="Contains more than 40,000 objects">
					<img class="inline valign" id="2pBadge" style="display: none; height: 9%; margin-left: -7%; cursor:help" src="../assets/twoPlayer.png" title="Two player level">
				</h2><br>
				<h3 class="pre slightlySmaller" style="margin-left: -11%; transform: scale(0.8); color:#ff82ff" id="songname">[[SONGNAME]]</h3>
			</div>

			<div style="position: absolute;display: flex;top: 68%;right: 9%;height: 115%;width: 85%;transform: scale(0.8);">
				<img class="inline spaced" src="../assets/time.png" height=15%>
				<h1 class="inline smaller spaced" style="padding: 0 5% 0 1%;">[[LENGTH]]</h1>
				<img class="inline spaced" src="../assets/download.png" height=15%>
				<h1 class="inline smaller spaced" style="padding: 0 5% 0 1%;">[[DOWNLOADS]]</h1>
				<img id="likeImg" class="inline spaced" src="../assets/like.png" height=15%>
				<h1 class="inline smaller spaced" style="padding: 0 5% 0 1%;">[[LIKES]]</h1>
				<img id="gdItem21" class="inline spaced orbs" src="../assets/orbs.png" height=15%>
				<h1 id="gdItem21" class="inline smaller spaced orbs" style="padding: 0 5% 0 1%;">[[ORBS]]</h1>
			</div>

			<div style="position: absolute;display: flex;top: 25%;right: -60%;height: 115%;width: 85%;transform: scale(0.8);">
				<img class="gdbutton inline spaced" src="../assets/view.png" onclick='levelRedirect(`[[ID]]`)' height=35%>
			</div>

			<div class="center" style="position:absolute;top: -47%;left: 0%;right: 0%;height: 60%;">
				<img class="inline spaced dailyLevel" id="dailyIcon" style="height:90%; margin-right: 0.5%; margin-top: 0.4%; vertical-align: middle;">
			</div>

			
		</div>
			<div class="center" style="position:absolute;top: 55%;left: 0%;right: 0%;display: flex;width: 100%;height: 35%;flex-direction: column-reverse;">
				<h2 class="inline smallerer spaced dailyLevel" style="display: none; margin: 0 0 0 0">New <span class="textTypeEvent">daily</span> level in:<span id="dailyTime"></span></h2>
				<h1 class="inline smallerer spaced dailyLevel" style="display: none; margin: 0 0 0 0">Daily #[[DAILYNUMBER]]</h1>
			</div>
		
	</div>


	<div id="copied" style="display: none;">
		<div class="copied center noClick" style="position:absolute; top: 36%; left: 50%; transform: translate(-50%,-50%); width: 90vh">
			<h1 class="smaller noSelect" id="copiedText">ID copied to clipboard</h1>
		</div>
	</div>

</div>

</body>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script type="text/javascript" src="../misc/gdcustomframe.js"></script>

<script>
	let userPermissions = [[USERPERMISSIONS]]
</script>
<script>
$("#loading-main").hide()
let legacyServer = true;
let gdpsVersion = "[[GDPSVERSION]]";
var maxGDPSVersion = 23;

const gmdData = `[[GMDDATA]]`;



if ('[[SERVERTYPE]]' != "legacy"){
	legacyServer = false;
}

function generateRandomBox() {
	console.log("test");
	const classes = ["purpleBox", "greenBox", "brownBox", "blueBox", "grayBox"];
	$("#randomBox").removeClass("brownBox").addClass(classes[Math.floor(Math.random() * classes.length)]);
}

generateRandomBox();

// --------

let typeEvent = 'daily';
if (!'[[WEEKLY]]'.startsWith("[")) typeEvent = 'weekly';
else if (!'[[EVENT]]'.startsWith("[")) typeEvent = 'event';


function profileRedirect(url) {
	var queryProfile = "";
    if (legacyServer == true) {
		queryProfile = "../../profile/?u=" + (encodeURIComponent(url).replace(/%2F/gi, "") || "");
	} else {
		queryProfile = "../../profile/" + (encodeURIComponent(url).replace(/%2F/gi, "") || "") 
	}
    if (queryProfile) window.location.href = "./u/" + queryProfile
}

function levelRedirect(url) {
	var queryLvl = "";
    if (legacyServer == true) {
		queryLvl = "/level/?id=" + (encodeURIComponent(url) || "0")
	} else {
		queryLvl = "/level/" + (encodeURIComponent(url) || "0")
	}
    if (queryLvl) window.location.href = ".." + queryLvl
}

function searchRedirect(url_browser,type) { // CUSTOM FOR THE SAFE
	var queryLvl = "";
	if(type.startsWith("!safe")) type = `${typeEvent}`
	if (legacyServer == true) {
		queryLvl = "/search/search.php?s=" + (encodeURIComponent(url_browser) || "0")
		if (type != null) queryLvl += "&thesafe=" + type;
	} else {
		queryLvl = "/search/" + (encodeURIComponent(url_browser) || "0")
		if (type != null) queryLvl += "?thesafe=" + type;
	}

	if (queryLvl) window.location.href = ".." + queryLvl
}

//////////////////// ----------- 

$(document).ready(function() { 

if ('[[ID]]'.startsWith('[')) {
	window.location.href = "./index.php?id=1";
} else if("[[ID]]" === "-1") {
	$("#randomBox").hide();
}

// BOUNCE ENTER FROM LEVEL
setTimeout(() => {
    let randomDirection = Math.random() < 0.5 ? "bounceLeft" : "bounceRight";
    $("#randomBox").removeClass("outsideBox").addClass(randomDirection);
}, 500);

function colonize(secs, timeUp) {
	if (secs < 0) {
		if (timeUp) return "Time's up!"
		else secs = 0
	}
	let days = Math.floor(secs / 86400)
	if (days) secs -= days * 86400
    return `${days ? `${days}d + ` : ""}${[Math.floor(+secs / 3600), Math.floor(+secs / 60) % 60, +secs % 60].map(v => v < 10 ? "0" + v : v).filter((v,i) => v !== "00" || i > 0).join(":")}`
}
let freeze = false;
let dailyTime = Number('[[NEXTDAILY]]') || null;

$('.closeWindow').click(function () { if (!freeze) $(".popup").attr('style', 'display: none;') })

$('#difficultytext').html('[[DIFFICULTY]]'.replace(' ', "<br>"))


console.log("Type of event:", typeEvent)

if ([[LARGE]]) $('#largeBadge').show()
if ([[TWOPLAYER]]) $('#2pBadge').show()
if ([[COPIEDID]] > 0) $('#copiedBadge').show()
if ([[ORBS]] == 0) $('.orbs').hide();
if ([[STARS]] == 0) $('.stars').hide()
if ([[DIAMONDS]] == 0) $('.diamonds').hide()

if (!'[[DAILYNUMBER]]'.startsWith("[")) {
	
	$('#dailyIcon').attr('src', `../assets/crown-${typeEvent}.png`);


	$('.dailyLevel').show()

	if (dailyTime) {
		$('#dailyTime').html(` ${colonize(dailyTime, true)} `)
		setInterval(() => {
			dailyTime -= 1
			$('#dailyTime').html(` ${colonize(dailyTime, true)} `)
		}, 1000);
	}
}
else $('.dailyLevel').remove()

if ("[[SONGID]]".startsWith("Level")) {
	$('#songInfo').text('[[SONGID]]')
	$('.songLink').hide()
}


if ("[[SONGAUTHOR]]" == "Unknown" || "[[INVALIDSONG]]" == "true") $('.songLink').hide()
if ("[[DISLIKED]]" == "true") $('#likeImg').attr('src', '../assets/dislike.png').css('transform', 'translateY(20%)')


let coinColor = "[[VERIFIEDCOINS]]" ? "silvercoin" : "browncoin"
if ([[COINS]] > 0) $("#coins").append(`<img src="../assets/${coinColor}.png" height="5%">`)
if ([[COINS]] > 1) $("#coins").append(`<img class="squeeze" src="../assets/${coinColor}.png" height="5%">`)
if ([[COINS]] > 2) $("#coins").append(`<img class="squeeze" src="../assets/${coinColor}.png" height="5%">`)


if ("[[ACCOUNTID]]" == "0") {
	$("#authorName").addClass("green").addClass("unregistered")
	$("#authorLink").attr('onclick', `profileRedirect('[[PLAYERID]]','playerID')`)
}

if(typeEvent == "event") {
	$("#dailyLabel").attr('src', '../assets/tabspecial/eventLevelLabel.png');
	$("#backgroundBox").removeClass("brownBox").addClass("whiteBox");
	$('#backgroundBox').css({'mix-blend-mode':'multiply'});
	$('#backgroundColorBox').css({'background-color':'#460955'});
	$('#borderColorBox').css({'background-color':'#c91df6'});
} else if (typeEvent == "weekly") {
	$("#dailyLabel").attr('src', '../assets/tabspecial/weeklyLevelLabel.png');
	$("#backgroundBox").removeClass("brownBox").addClass("whiteBox");
	$('#backgroundBox').css({'mix-blend-mode':'multiply'});
	$('#backgroundColorBox').css({'background-color':'#585454'});
	$('#borderColorBox').css({'background-color':'#f6fbfe'});
	$('.cornerPiece').css({'filter': 'grayscale(1)'});
}

});
</script>

<script type="text/javascript" src="../misc/versionadapter.js"></script>
